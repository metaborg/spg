module types

language L2
start symbol Start

test assignment [[
  record Foo {
    bar: Int
  }
  
  begin
    [[new Foo]].bar := 5
  end
]] run get-type on #1 to TRec(Occurence(_, "Foo", _))

test assignment [[
  record Foo {
    bar: Int
  }
  
  begin
    [[new Foo.bar]] := 5
  end
]] run get-type on #1 to TInt()

test type of assignment [[
  record Foo {
    bar: Int
  }
  
  begin
    [[new Foo.bar := 5]]
  end
]] run get-type on #1 to TInt()

test type of seq is last exp [[
  record Foo {
    bar: Int
  }
  
  begin
    [[foo.bar := 5; new Foo]]
  end
]] run get-type on #1 to TRec(Occurence(_, "Foo", _))
