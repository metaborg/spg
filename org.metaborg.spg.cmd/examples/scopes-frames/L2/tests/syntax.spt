module syntax

language L2
start symbol Start

test program without declarations [[
  begin
    5
  end
]] parse succeeds

test declaration without fields [[
  record foo {
  }
  
  begin
    5
  end
]] parse succeeds

test declaration with single field [[
  record foo {
    bar: Int
  }
  
  begin
    5
  end
]] parse succeeds

test declaration with multiple fields [[
  record foo {
    bar: Int
    baz: Int -> Int
  }
  
  begin
    5
  end
]] parse succeeds

test assignment [[
  record foo {
    bar: Int
  }
  
  begin
    foo.bar := 5
  end
]] parse succeeds

test sequence of assignments [[
  record foo {
    bar: Int
    baz: Int
  }
  
  begin
    foo.bar := 5;
    foo.baz := 6
  end
]] parse succeeds
