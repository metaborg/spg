module dynamics/heap

imports
  dynamics/values 
    
signature

  sort aliases
    Heap = Map(Int, V)
    
  components
    H : Heap
    
  arrows
    read(Int) --> V
    allocate(V) --> Int
    write(Int, V) --> V

rules

  read(a) :: H --> H[a].

  write(a, v) :: H --> v :: H {a |--> v, H}.

  allocate(v) --> a
  where
    fresh => a;
    write(a, v) --> _.
  